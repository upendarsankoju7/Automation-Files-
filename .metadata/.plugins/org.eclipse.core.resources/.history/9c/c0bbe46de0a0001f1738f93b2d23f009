package Automation_Opencart;

import java.io.File;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.StandardCopyOption;
import java.time.Duration;

import org.openqa.selenium.By;
import org.openqa.selenium.OutputType;
import org.openqa.selenium.TakesScreenshot;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;

public class ScreenShot_1 {

	public static void main(String[] args) {
		// Set up the WebDriver and launch Chrome browser
		WebDriver driver = new ChromeDriver();
		
		// Set an implicit wait of 10 seconds for the WebDriver
		driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(10));
		
		// Open the URL in Chrome browser and maximize the window
		driver.get("https://demo.nopcommerce.com/");
		driver.manage().window().maximize();
		
		try {
			// 1) Full page screenshot
			TakesScreenshot ts = (TakesScreenshot) driver;
			File sourceFileFullPage = ts.getScreenshotAs(OutputType.FILE);
			File targetFileFullPage = new File(System.getProperty("user.dir") + "\\screenshots\\fullpage.png");
			Files.copy(sourceFileFullPage.toPath(), targetFileFullPage.toPath(), StandardCopyOption.REPLACE_EXISTING);
			System.out.println("Full page screenshot captured and saved as fullpage.png.");
			
			// 2) Screenshot of a specific section
			WebElement featuredProducts = driver.findElement(By.xpath("//div[@class='product-grid home-page-product-grid']"));
			File sourceFileSection = featuredProducts.getScreenshotAs(OutputType.FILE);
			File targetFileSection = new File(System.getProperty("user.dir") + "\\screenshots\\featuredproducts.png");
			Files.copy(sourceFileSection.toPath(), targetFileSection.toPath(), StandardCopyOption.REPLACE_EXISTING);
			System.out.println("Section screenshot captured and saved as featuredproducts.png.");
			
			// 3) Screenshot of a specific WebElement (logo)
			WebElement logo = driver.findElement(By.xpath("//img[@alt='nopCommerce demo store']"));
			File sourceFileLogo = logo.getScreenshotAs(OutputType.FILE);
			File targetFileLogo = new File(System.getProperty("user.dir") + "\\screenshots\\logo.png");
			Files.copy(sourceFileLogo.toPath(), targetFileLogo.toPath(), StandardCopyOption.REPLACE_EXISTING);
			System.out.println("Logo screenshot captured and saved as logo.png.");
			
		} catch (IOException e) {
			e.printStackTrace();
		} finally {
			// Close the browser
			driver.quit();
		}
	}
}
